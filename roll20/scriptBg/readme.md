# [roll20 API] scriptBg.js

롤20의 좌측 화면에서 실시간으로 스크립트를 출력할 수 있는 API 입니다.

## 업데이트 로그
200420. 버그 및 안정성 개선

## 요약

- 스크립트 출력용 배경으로 설정한 범위 내에서 채팅 내용이 이름과 함께 출력됩니다. 
- 일반 채팅, desc를 지원합니다.
- api 온오프가 가능합니다. 
- 연출을 위한 타이핑 효과 모드가 존재합니다. (일반 대화 용도로는 비추천)
- 스크립트 출력용 배경을 자유롭게 설정할 수 있습니다. 지나치게 작은 사이즈가 아니라면 크기 역시 자유로운 설정이 가능합니다. 
- 이름, 내용, desc 글씨색을 자유롭게 설정할 수 있습니다. 손쉬운 설정을 위한 토큰을 세팅할 수 있습니다. 모든 텍스트 컬러는 기본적으로 흰색으로 설정되어 있습니다. (14~18 라인에서 변경 가능)



### 설명서

```
**주의사항!** 해당 기능 세팅 시 **화면에 다른 텍스트가 입력된 상태여서는 안됩니다**.(채팅창이 아닌 토큰 등이 깔리는 화면)
세팅 후에는 다른 텍스트를 입력해도 괜찮지만 **처음 세팅할 때에는** 반드시 어떠한 텍스트로 입력되지 않은 상태에서 세팅 과정을 따라주세요. 
```

1. 스크립트가 출력될 배경 이미지 파일을 토큰으로 꺼내둡니다. 이 토큰의 이름을 **scriptBg** 로 설정해주세요.
   이름과 텍스트의 출력 위치가 이미지 파일의 크기에 맞춰져서 자동으로 정해지므로 적당히 여유로운 사이즈로 배경이미지의 크기를 잡아주세요. 
2. 스크립트 배경 이미지를 설정한 후 **!sbOn** 를 채팅창에 입력, 혹은 스크립트 배경 이미지의 **첫번째 바** 값에 **1** 을 입력해주세요. **1이 스크립트 실행, 0이 스크립트 종료**입니다.
3. 채팅창에 **!ss** 를 입력해주시면 자동으로 스크립트를 사용할 준비가 끝납니다. 설정해둔 스크립트 배경 이미지 위에 '이름 출력 영역', '채팅 텍스트 출력 시작점' 이 뜬다면 제대로 준비가 된 것입니다. 이 다음부터는 자유롭게 채팅을 즐겨주시면 됩니다.
4. **!tp 내용** 의 양식으로 채팅창에 입력을 할 경우 **내용 부분이 타이핑 효과 모드**로 출력됩니다. 타이핑 효과가 실행되는 중에는 **채팅창에서 대화를 나누더라도 타이핑 효과 모드가 멈추지 않고 내용이 끝날 때 까지** 스크립트가 실행됩니다. 스킵 기능이 없기 때문에 부분적인 연출용으로의 사용을 권장드립니다. 
5. 스크립트 배경 이미지의 **두번째 바** 값은 **타이핑 효과 모드의 속도**입니다. 기본값은 80으로 설정이 되어있습니다. (1000 = 한 글자당 1초)
6. 간편한 글씨 색 관리용 토큰 세팅이 가능합니다. 아무 토큰이나 꺼내놓은 뒤 이름을 **ssTok** 으로 설정해주세요. 그리고 해당 토큰의 바에 각각 글씨 색 입력이 가능합니다. #000000 과 같은 컬러코드로 입력해주세요.
   1. 첫번째 바 값은 내용 색입니다.
   2. 두번째 바 값은 이름 색입니다.
   3. 세번째 바 값은 desc 색입니다.
7. 글씨 색 관리용 토큰 **ssTok**은 토큰의 움직임이나 내용의 변화를 감지해서 내용을 업데이트 합니다. 폰트 컬러를 입력했는데도 제대로 적용이 안 되었거나, 이전의 컬러로 돌아간 등의 상황이 발생했을 때 **토큰을 조금 움직여주면** 설정값을 다시 업데이트 할 것입니다.
8. 세팅 혹은 세션 중 오류 등이 발생하여 스크립트가 이상하게 출력되거나, 제대로 작동하지 않는다면 화면 내의 모든 텍스트 혹은 출력 영역을 전부 삭제하고 다시 처음부터 세팅해주시면 됩니다. 


#### Tip
1. 스크립트가 출력될 배경 이미지를 투명한 토큰으로 설정해서 스크립트가 출력될 영역만 잡아두고, 뒤에 예쁜 배경용 이미지를 깔아두면 더욱 예쁜 연출이 가능합니다.
2. 스크립트가 제대로 작동하고 있는지 확인하고 싶다면 API Output Console 창을 살펴봐주세요. 특별한 오류 메세지가 없다면 제대로 실행되고 있을 확률이 높습니다. 만약에 별다른 오류메세지가 없는데도 불구하고 스크립트가 제대로 작동하지 않는 걸로 보인다면, 스크립트를 재실행해 주시거나 처음부터 다시 세팅을 해주세요. 